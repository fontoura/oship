<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>Application Developer's Documentation</title>
  <meta name="generator" content="Amaya, see http://www.w3.org/Amaya/" />
</head>

<body>
<h1>OSHIP Application Developer's Documentation</h1>

<h2><a name="Introducti" id="Introducti">Introduction</a></h2>

<p>We will be using the Blood Pressure Demo to describe how applications are
developed using OSHIP. It is expected that the developer will be familiar
with the Python programming language as well as the Template Attribute
Language (TAL) required for data access in HTML pages as used in the Zope
Component Architecture and especially in Grok. This is meant to give a very
basic introduction as to how a Grok based application is put together. There
are many documents and a great communities to answer more indepth questions
about OSHIP/Grok/ZCA, etc.</p>

<p></p>

<h2><a name="Creating" id="Creating">Creating the Demo</a></h2>

<p>The demo application is created on the Grok applications page. If your
OSHIP server is up and running per the installation instructions then you
should be able to navigate to http://localhost:8080/applications and login
with your admin password. Enter 'bptrack' in the input box labeled:
oship.bptrack.bptrack Click the Createe button. You can now go to the demo
application at http://localhost:8080/bptrack. It will execute a short setup
routine (see below) and then redirect to
http://localhost:8080/bptrack/bpmain. From this main page you can add a
couple of demo patients. Note that the patient name shoould appear in the
listing on the left side of the page. It should be highlighted/underlined as
an HTML link. This link will take you from this patient's specific
demographic record to their clinical record. Creating entries in and using
the clinical record is described in the section titled <a
href="#The Clinical Record">The Clinical Record</a>.</p>

<p></p>

<h2><a name="Python" id="Python">The Python Code</a></h2>

<p>For the demo application, the Python code is contained in bptrack.py.
Though it uses a lot of underlying openEHR and Grok/Zope components. It is
most important in the beginning that the application developer concentrates
on this module. Most of the code is well documented as to what it does. It is
however important to have an understanding of how Grok works with regard to
Python code interacting with the page templates (HTML+TAL). </p>

<h3>Views - any class that inherits from grok.View:</h3>

<p>These can be thought of as the conntaining page for display to the
enduser.</p>

<p></p>

<h3>Viewlets - any class that inherits from grok.Viewlet:</h3>

<p>These are the smallest component of an applicatiion as far as the enduser
is concerned and usually are just snippets of HTML+TAL code that usually
define on activity. That activity may be to preseent output or accept
input.</p>

<p></p>

<h3>ViewletManagers - any class that inherits from grok.ViewletManager:</h3>

<p>These are the classes that determine the layout within a View. They are
the connectors between Viewlets and Views. </p>

<p></p>

<p>Though View and Viewlet class instances can produce output or perform
other activities via a render() method. They are most often connected with a
pagetemplate of the same name, in lowercase. For example the class BPMain is
a View. It calls bpmain.pt because it has no render method defined. You
cannot have both a render method and a page template defined for the same
class. Though you MUST have one or the other.</p>

<p></p>

<p>Notice just above BPMain is a class named Index. Index is called by
default for any application that does not otherwise have a different
pagetemplate defined in it's class declaration. See that bptrack is the
application class for this demo and it has no other methods or names
assigned. Indeex does have a render method defined, therefore there is no
page template named index.pt. The render method simply adds two grok
containers to the application. One for demographic information and one for
clinical information. In real life, large applications you could easily have
these two components on separate servers or maybe you already have a Master
Patient Index (MPI) that you want to connect to for demographics. This is all
doable but beyond the scope of this demo.</p>

<p>After creating the containers; Index does a redirect to bpmain, which is
the primary View class for this demo. Notice again that there is no render
method so Grok looks for the bpmain.pt file in bptrack_templates. Taking a
look at the source for bpmain.pt you will see that it basically contains the
standard HTML markup expected for a page. The layout is controlled via the
bpmain.css file located in the static/css subdirectory. In the body of
bpmain.pt, all that is defined is four &lt;div&gt; sections with TAL
attributes pointing to content providers. These content providers are Viewlet
Managers. They are:</p>
<ol>
  <li><strong>Header</strong> - it has one viewlet, pagetitle.pt</li>
  <li><strong>InfoArea</strong> - it has two viewlets. one for the patient
    add form (newpatient.pt) and one with just text warning (info.pt) about
    the fact that this is just a demo. Notice that the corresponding classes
    in bptrack.py container a call to grok.order() that determines where in
    the viewlet manager each viewlet will appear. This viewlet manager could
    have and probably should be divided into two separate managers in real
    applications. </li>
  <li><strong>Patients</strong> - it has two viewlets, one for a search box
    for surnames (patientshead.pt) and one that lists the curretly entered
    patients (PatientsList). Notice that the PatientsList class does not have
    an associated pagetemplate but a render method. More on this later. In a
    real world application with tens of thousands of patients this must be
    more robust and paginated. But there is no point in complicating this
    basic demo.</li>
  <li><strong>Footer</strong> - which on has one viewlet, (footertext.pt)
    which simply contains a copyright notice. </li>
</ol>

<p>Time for a quick recap. Pages (aka. Views) contain ViewletManagers. These
viewlet managers, defined in &lt;div&gt;'s are laid out using CSS and their
associated id. Viewlets contain snippets of HTML/TAL and are associated with
a specific viewlet manager and have an order specified within that
manager.</p>

<p>Each pagetemplate must have an associated View or Viewlet class defined
within the application context (Python code). ViewletManagers are associated
as sections inside a View and are defined as content providers. The
&lt;div&gt; id is used to associate it with the CSS file.</p>

<p></p>

<p> </p>

<p></p>

<p> </p>

<p></p>

<p></p>

<p></p>

<p></p>

<h3><a name="Clinical" id="Clinical">The Clinical Record</a></h3>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>
</body>
</html>
